title: CVE-2024-23666 - FortiManager SSH Web Console Exploitation Script
id: 2b63ffb1-af74-4ee0-8d9c-78e8c3ad9304
status: experimental
description: FortiManager SSH web console exploitation script simulating a shell on a FortiGate
license: DRL-1.1
references:
    - https://www.synacktiv.com/advisories/fortimanager-multiple-vulnerabilities
    - https://fortiguard.fortinet.com/psirt/FG-IR-23-396
author: Synacktiv, Maxence Fossat [@cybiosity]
date: 2025-02-03
modified: 2025-02-03
tags:
    - cve.2024-23666
    - attack.lateral-movement
    - attack.t1210
    - tlp.clear
    - pap.clear
correlation:
    type: temporal
    rules:
        - be1e0ec6-9cf8-49ba-aec0-fe380c74a23b  # FortiManager Low-privilege User Login Success
        - f4f2111e-ff70-4b1b-a452-fce8632df20e  # FortiManager FlatUI Login Success
        - c8bb72aa-6c3f-4c3c-8fa4-8a5ca9cb539a  # FortiManager WebSocket Connection
        - 7a51b629-10b7-430d-a1d2-3fd0afc11937  # FortiManager SSH Web Console Connection
        - 7d57d500-4320-4bdd-832c-62e2997921d0  # FortiManager SSH Web Console Data Write
    timespan: 10m
falsepositives:
    - Legitimate administrative actions by high-privilege users not in the filter
level: high