title: CVE-2023-42791 | CVE-2024-23666 - Remote Code Execution On FortiManager
id: 6e11dd3e-b3a7-4703-a60e-2ad36742f979
status: experimental
description: Exploitation script dropping a reverse shell or creating a new admin user via a low-privilege user
license: DRL-1.1
references:
    - https://www.synacktiv.com/advisories/fortimanager-multiple-vulnerabilities
    - https://www.fortiguard.com/psirt/FG-IR-23-189
    - https://fortiguard.fortinet.com/psirt/FG-IR-23-396
author: Synacktiv, Maxence Fossat [@cybiosity]
date: 2025-02-03
modified: 2025-02-03
tags:
    - cve.2023-42791
    - cve.2024-23666
    - attack.initial-access
    - attack.t1190
    - attack.lateral-movement
    - attack.t1210
    - tlp.clear
    - pap.clear
correlation:
    type: temporal
    rules:
        - be1e0ec6-9cf8-49ba-aec0-fe380c74a23b  # FortiManager Low-privilege User Login Success
        - f4f2111e-ff70-4b1b-a452-fce8632df20e  # FortiManager FlatUI Login Success
        - f2e3749a-7d26-4c86-bec1-1da24cad99f6  # FortiManager Multiple Uploads
        - 99a0e638-9046-49a1-b032-124051a1bbe7  # FortiManager Logout
    timespan: 2m
falsepositives:
    - Legitimate administrative actions by high-privilege users not in the filter
level: high